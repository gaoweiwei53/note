# 1. NoSql的四大分类
## KV键值对
- 新浪：Redis
- 美团：Redis + Tair
- 阿里百度：Redis + memecache
## 文档型数据库
- MongoDB
## 列数据库
- HBse
- 分布式文件系统
## 图关系数据库

# 2. Redis安装
1. make编译 可以选择make install 
2. 分别拷贝 命令和配置文件至新建的文件夹 bin conf
3. 修改配置文件，设置后台启动
4. 启动Redis
5. 查看进程
```bash
ps -ef|grep redis
```
6. 退出连接 shutdown exit

# 3. Redis基础知识
1. redis默认有16个数据库，默认的是第0个，可以使用`select`命令切换
 `DBSIZE` 查看数据库空间大小
 `keys *` 查看所有的key
 `flushdb` 清空当前数据库
 `FLUSHALL` 清空所有记录
2. Redis是单线程的
redis是基于内存操作，CPU不是redis的瓶颈

# 4. Redis的5大数据类型
- String
- List
- Set
- Hash
- Zset  

`EXISTs keyname`: 查看键是否存在

`move keyname 1`: 移除该key记录？

`type key`: 查看类型  

### 1. String类型
`APPEND key ***`: 在次key对于的value后追加字符串

`STRLEN  key`: 查看长度

# 5. Redis事务
Redis事务本质：一组命令的集合！一个事务中的所有命令都会被序列化，在事务执行过程中，会按照顺序执行！

一次性、顺序性、排他性

==redis事务没有隔离级别的概念==

所有命令在事务中没有被执行，只有发起执行命令时才执行

Redis单条命令保证原子性的，但是事务不保证原子性  
redis的事务：
- 开启事务(multi)
- 命令入队()
- 执行事务(exec)
- 放弃事务(DISCARD)

编译型异常(代码有问题)：所有的命令都不会执行  
运行时异常():其他命令可以正常执行  
监控！  
**悲观锁**： 很悲观，认为什么时候都会出现问题，无论做什么都会加锁！
**乐观锁**： 认为不会出现问题，不上锁。更新数据的时候判断是否有人修改过数据
- 获取version
- 更新的时候比较version

#6. Redis持久化
## RDB
在指定的时间间隔内将内存中的数据集快照写入磁盘，redis会单独创建fork子线程来进行持久化

## AOF
将所有命令记录下来，恢复的时候把这个文件全部执行一遍

# 7. Redis缓存穿透与雪崩
## 缓存穿透(查不到)
用户查询数据，redis里没有，于是向持久层数据库查询。当查询很多的时候，缓存都没有命中，请求数据库，这种现象称为缓存穿透。
### 解决方案
### 1 布隆过滤器
### 2 缓存空对象

## 缓存击穿(量太大)
### 解决方案
### 1 设置热点数据永不过期
### 2 加互斥锁
分布式锁

## 缓存雪崩
指在一个时间段，缓存集中过期失效，redis宕机
### 解决方法
### 1 redis高可用
### 2 限流降级
### 3 数据预热
